###############################

# GIORNO 1

###############################

## Introduzione a DevOps

### La "vecchia scuola"

### Il DevOps 

DevOps è una filosofia e un framework in evoluzione che promuove uno sviluppo applicativo migliore e più efficace e una release più rapida di prodotti o funzionalità software, nuovi o aggiornati, ai clienti.

Le pratiche di DevOps favoriscono comunicazioni, collaborazioni, integrazione, visibilità e trasparenza continue e più semplici tra i team di sviluppo delle applicazioni (Dev) e le controparti del team operativo IT (Ops).

Questa stretta relazione tra "Dev" e "Ops" permea ogni fase del ciclo di vita DevOps: dalla pianificazione iniziale del software alle fasi di codifica, creazione, test e release, fino all'implementazione, alle operazioni e al monitoraggio continuo. Inoltre, genera un ciclo continuo di attività di miglioramento, sviluppo, test e implementazione basato sul feedback dei clienti. Uno dei risultati di tali pratiche può essere la release continua e più rapida delle modifiche o delle integrazioni delle funzionalità necessarie.

Alcuni suddividono gli obiettivi di DevOps in quattro categorie, Cultura, Automazione, Misurazione e Condivisione (CAMS), ovvero tutte aree nelle quali l'utilizzo dei tool di DevOps può essere vantaggioso. Questi strumenti possono rendere i flussi di lavoro delle operazioni e dello sviluppo più semplici e collaborativi, automatizzando le attività manuali o statiche, che in precedenza richiedevano molto tempo, collegate alle fasi di integrazione, sviluppo, test, implementazione o monitoraggio.

VANTAGGI DELLA METODOLOGIA DEVOPS

La metodologia DevOps è fondamentale non solo perché si pone l'obiettivo di abbattere le barriere alla comunicazione e alla collaborazione tra team di sviluppo e team operativi IT, ma anche ai fini di una maggiore soddisfazione dei clienti e rapidità nell'offerta di valore. DevOps è inoltre progettato per promuovere l'innovazione del business e favorire il miglioramento continuo dei processi.

Le pratiche di DevOps incoraggiano un'offerta di valore di business più rapida, migliore e sicura ai clienti finali di un'organizzazione. Questo valore può esprimersi sotto forma di release, funzionalità o aggiornamenti dei prodotti più frequenti. Può riguardare la rapidità con cui la release di un prodotto o di una nuova funzionalità diventa accessibile ai clienti, senza tuttavia compromettere i corretti livelli di qualità e sicurezza. Oppure, può concentrarsi sulla rapidità con cui viene identificato e risolto un problema o un bug prima di una nuova release.

L'infrastruttura sottostante supporta le pratiche di DevOps anche con performance, disponibilità e affidabilità del software ottimali, grazie ai processi di sviluppo e test che precedono l'invio del software all'ambiente di produzione.

METODI DEVOPS

Esistono alcuni metodi DevOps di uso comune che le organizzazioni possono adottare per accelerare e migliorare lo sviluppo e le release dei prodotti. Si tratta di metodologie e pratiche di sviluppo software. Tra le più popolari sono incluse Scrum, Kanban e Agile:

Scrum. 

Scrum definisce il modo in cui i membri di un team devono collaborare per accelerare i progetti di sviluppo e QA. Le pratiche di Scrum includono flussi di lavoro chiave e terminologia specifica (sprint, time box, daily scrum [meeting]), nonché ruoli designati (Scrum Master, Product Owner).

Kanban. 

Kanban è una metodologia nata dalle pratiche efficienti adottate nello stabilimento della Toyota. Kanban prevede che lo stato di un progetto software Work in Progress (WIP) venga monitorato su una lavagna Kanban.

Agile. 

Le prime metodologie agili di sviluppo software continuano a influenzare notevolmente le pratiche e i tool DevOps. Molte metodologie DevOps, tra cui Scrum e Kanban, incorporano elementi di programmazione agile. Alcune pratiche agili sono associate a una maggiore reattività alle esigenze e ai requisiti in continua evoluzione, sulla base di pratiche di documentazione dei requisiti specifici degli utenti, relazioni quotidiane e integrazione dei feedback continui dei clienti. L'agilità impone inoltre cicli di vita per lo sviluppo del software più brevi invece dei lunghi e tradizionali metodi di sviluppo "a cascata".

TOOLCHAIN DEVOPS

I seguaci delle pratiche DevOps spesso utilizzano alcuni tool compatibili con DevOps come parte della loro "toolchain" DevOps. L'obiettivo di questi strumenti è quello di ottimizzare, ridurre e automatizzare ulteriormente le varie fasi del flusso di lavoro di delivery del software (o "pipeline"). Molti di questi tool promuovono anche i principi DevOps fondamentali di automazione, collaborazione e integrazione tra team di sviluppo e operativi. Di seguito sono indicati alcuni tool di esempio utilizzati nelle varie fasi del ciclo di vita DevOps.

Pianificazione. 
In questa fase vengono definiti il valore e i requisiti di business. I tool di esempio includono Jira o Git per tenere traccia dei problemi noti ed eseguire la gestione dei progetti.
Codifica. 
Questa fase prevede la progettazione del software e la creazione del relativo codice. I tool di esempio includono GitHub, GitLab, Bitbucket o Stash.
Creazione. 
In questa fase vengono gestite le build e le versioni del software e utilizzati tool automatici per la compilazione e la creazione del package del codice per la successiva release inviata in produzione. Vengono utilizzati repository di codice o repository di pacchetti sorgente che includono anche l'infrastruttura necessaria per la release del prodotto. I tool di esempio includono Docker, Ansible, Puppet, Chef, Gradle, Maven o JFrog Artifactory.
Test. 
Questa fase prevede test continui (manuali o automatici) per garantire la qualità ottimale del codice. I tool di esempio includono JUnit, Codeception, Selenium, Vagrant, TestNG o BlazeMeter.
Implementazione. 
Questa fase può includere tool che consentono di gestire, coordinare, pianificare e automatizzare le release dei prodotti in produzione. I tool di esempio includono Puppet, Chef, Ansible, Jenkins, Kubernetes, OpenShift, OpenStack, Docker o Jira.
Gestione. 
Questa fase riguarda la gestione del software durante la produzione. I tool di esempio includono Ansible, Puppet, Bash, Chef, Salt o Otter.
Monitoraggio. 
Questa fase prevede l'identificazione e la raccolta di informazioni sui problemi di una release software specifica in fase di produzione. 
I tool di esempio includono New Relic, Datadog, Grafana, Wireshark, Splunk, Nagios o Slack.

PRATICHE DEVOPS

Le pratiche DevOps riflettono l'idea di un miglioramento e un'automazione continui. Molte pratiche si concentrano su una o più fasi del ciclo di sviluppo. Queste includono:

Sviluppo continuo. 

Questa pratica riguarda le fasi di pianificazione e codifica del ciclo di vita DevOps, ma potrebbe interessare anche i meccanismi di controllo delle versioni.
Test continui. Questa pratica include test del codice automatizzati, programmati e continui, durante la scrittura o l'aggiornamento del codice dell'applicazione. 
Tali test possono accelerare la delivery del codice alla produzione.

Integrazione continua.

Questa pratica integra i tool di gestione della configurazione con altri tool di test e sviluppo per monitorare quanto del codice in fase di sviluppo è pronto per la produzione. Implica un rapido feedback tra ambiente di test e di sviluppo per identificare e risolvere rapidamente i problemi relativi al codice.

Delivery continua.

Questa pratica automatizza la delivery delle modifiche del codice, successive al test, a un ambiente di pre-produzione o di staging.
Un membro dello staff potrebbe quindi decidere di promuovere tali modifiche del codice in produzione.

Deployment continua. 

Simile alla delivery continua, questa pratica automatizza la release di codice nuovo o modificato in produzione. Un'azienda che esegue un'implementazione continua potrebbe rilasciare modifiche di codice o funzionalità diverse volte al giorno. L'utilizzo di tecnologie container, come Docker e Kubernetes, può consentire un'implementazione continua e contribuire a mantenere la coerenza del codice tra piattaforme e ambienti di implementazione differenti.

Monitoraggio continuo.

Questa pratica prevede il monitoraggio continuo del codice implementato e dell'infrastruttura sottostante che lo supporta. Successivamente, un loop di feedback che segnala eventuali bug o problemi viene restituito all'ambiente di sviluppo.

Infrastruttura come codice. 

Questa pratica può essere utilizzata durante varie fasi DevOps per automatizzare il provisioning dell'infrastruttura richiesto per una release del software. Gli sviluppatori aggiungono il "codice" dell'infrastruttura dai propri tool di sviluppo. Ad esempio, gli sviluppatori potrebbero creare un volume di storage on-demand da Docker, Kubernetes o OpenShift. Tale pratica, inoltre, consente ai team operativi di monitorare le configurazioni dell'ambiente, tenere traccia delle modifiche e semplificare il rollback delle configurazioni.

BENEFICI DI DEVOPS
I sostenitori di DevOps ne descrivono diversi vantaggi tecnici e aziendali, molti dei quali contribuiscono a migliorare la soddisfazione dei clienti. Alcuni di questi vantaggi chiave includono:

Delivery dei prodotti più rapida ed efficiente
Risoluzione dei problemi più rapida e complessità ridotta
Maggiore scalabilità e disponibilità
Ambienti operativi più stabili
Migliore utilizzo delle risorse
Maggiore automazione
Maggiore visibilità sui risultati del sistema
Maggiore innovazione

### Introduzione alla CI/CD

CI/CD è un approccio per lo sviluppo del software, focalizzato sull'automazione delle procedure che portano il codice dallo sviluppo all'integrazione, dal test alla distribuzione e deployment finale. Infatti CI fa riferimento alla metodologia di Integrazione Continua, mentre CD a quella di Distribuzione Continua e/o Deployment Continuo, che pur indicando livelli di automazioni diversi vengono spesso usati in modo intercambiabile.

Ecco come le diverse metodologie si integrano in un unico flusso di automazione:

- le modifiche al software vengono caricate in un repository condiviso

- le modifiche al repository vengono automaticamente rilevate, compilate e testate

- se compilazione e test danno esito positivo, il pacchetto contenente le modifiche può venire distribuito.

Con distribuzione continua si intende il processo con il quale le modifiche apportate da uno sviluppatore all'applicazione vengono automaticamente testate alla ricerca di bug e caricate in un repository ( come GitLab o un container  registry ), dal quale vengono distribuite in un ambiente di produzione dai team operativi. È una soluzione al problema della scarsa visibilità e comunicazione tra i team di sviluppo e quelli operativi. In questo senso la distribuzione continua ha il fine di garantire interventi manuali minimi per distribuire il nuovo codice.

L'altro acronimo possibile per "CD", deployment continuo, può riferirsi al rilascio automatico delle modifiche apportate dallo sviluppatore dal repository alla produzione, dove diventano fruibili ai clienti. In tal modo, si evita di sovraccaricare i team operativi con procedure manuali, che altrimenti rallenterebbero la distribuzione delle applicazioni. Questa fase sfrutta i vantaggi della distribuzione continua, automatizzando la fase successiva del flusso.

CI/CD è un metodo per la distribuzione frequente delle app ai clienti, che prevede l'introduzione dell'automazione nelle fasi di sviluppo dell'applicazione. Principalmente, si basa sui concetti di integrazione, distribuzione e deployment continu

Il flusso di integrazione e distribuzione continue (CI/CD) introduce il monitoraggio e l'automazione per ottimizzare il processo di sviluppo delle applicazioni, in particolare nelle fasi di integrazione e test, nonché durante la distribuzione e il deployment. Il vantaggio principale dell'integrazione e distribuzione continue (CI/CD) sta nell'automazione delle procedure, benché ognuna di esse possa essere eseguita manualmente.

### La DevOps Toolchains
```
. IDE ( Integrated Development Environment )
    vsCode
    IntelliJ

. Versionamento
    Jenkins
    Git

. Deploy
    Docker
    Kubernetes

. Configuration management 
    Ansible
    Chef
    Puppet

. Cloudformation 
    Terraform
    ( Vagrant )

. Monitoraggio
    Nagios
    Prometheus
    Grafana

. CI/CD Frameworks
    GitHub
    GitLab
    CircleCI 

. CMS
    OpenProject
    Asana
```

## GitOps, un'introduzione

GitOps e' un gruppo di pratiche di deploy, mentre DevOps e' un paradigma operativo, un modo di approcciarsi al lavoro.

### I quattro comandamenti del GitOps
1. Git per ogni cosa, ad esempio:
    -  il versioning
    -  l'integrazione
    -  il deploy
    -  il configuration management, estendendo le capacita' di self-healing dell'infrastruttura
  2. V per Versionamento, diffs e rollbacks automatizzati
  3. Auto-Pull, questa funzione di git permette un controllo costante dello stato dei cluster
  4. Loop the loop 

## Git
### Cos'e' Git?
"Global Information Tracker"

https://git-scm.com/book/it/v2/Per-Iniziare-Cos%E2%80%99%C3%A9-Git%3F

. cosa e' un repository ?
Un "repo" e' semplicemente un database che contiene tutte le informazioni 
per gestire le revisioni e la storia del progetto.
Come altri sistemi di versionamento, git contiene sia la copia completa 
delle versioni, sia la "vera" working directory.
Il tutto e' gestito nella cartella nascosta ".git", all'interno della WD,
in strutture chiamati "object stores" e "index".
Il primo e' progettato per essere clonato OGNI volta e aggiornato ad ogni
commit/push, l'index e' relativo al repository.

Gli oggetti di Git sono:
. blobs: e' un "binary large object" ed e' il riferimento all'HASH generato
in fase di commit
. trees: descrive la gerarchia della WD
. commits: contiene i metadata di ogni cambiamento effettuato nel repository.
Ognuno punta ad un tree, che cattura una snapshot dell'attuale stato in cui 
il commit e' stato eseguito.
. tags: e' un nome leggibile da un umano, alias per l'HASH
L'HASHing viene eseguito passando al cypher SHA1 il contenuto dei file 
presenti in repository e lui produce una stringa di 40 caratteri esadecimali,
come output.
A lui non interessa come i si chiamano i file, ma cosa contengono.
Si usa SHA1 per l'hashing perche' e' una "hash crittograficamente sicuro"
che garantisce una possibilita' di non unicita' a 10 alla quarantottesima.

Gli Index sono dei file binari, temporanei e dinamici che describono la
struttura delle cartelle presenti nel repo.

GIT non e' un VCS ( Version Control System ) ma un Content Tracking System.

### I comandi base

. definire l'account utente
git init
git config --global user.name "greleaser"
git config --global user.email greleaser@example.com
git config --global core.editor vim
git config --global init.defaultBranch main

git config --list

. definire le variabili d'ambiente del repository

git remote add origin git@10.0.0.15:root/nginx-test.git
git branch -M main

. il primo PUSH

<-- git reset --mixed origin/main # potrebbe essere necessario --> 
echo "Repo nginx-test.git appena creato" >> README.md
git add -A .
git commit -m "Repo nginx-test.git appena creato" --author="greleaser <greleaser@example.com>"
git push --set-upstream origin main

. controlliamo i log

git log
git show <HASH>
it show-branch --more=10
git diff <HASH1> <HASH2>
git rm <nome file>

. cloniamo il  del repo
git commit -m "Ho tolto il file <nome file>" --author="greleaser <greleaser@example.com>"


## Introduzione a GitLab

sulla vm "gateway"
login
ip -br a s eth2 | awk '{print $3}'
inseriamo solo l'ip nella barra degli indirizzi del browser
nella pagina di login di gitlab inseriamo

`ID -> root / PWD -> ciao`

dalla vm "controlplane" prendiamo il


Installazione e configurazione di base di GitLab (in container)

La dashboard di GitLab

Il modello di securiity di GitLab

Creare un progetto

### GIT first configuration
```
cd /opt/CI-CD/Giorno_2_Docker/nginx-test-repo/
git config --global user.name "greleaser"
git config --global user.email greleaser@example.com
git config --global core.editor vim
git config --global init.defaultBranch main
```

prendi la chiave privata di greleaser dalla vm controlplane 
settings
cicd
variables
greleaser private key -> SSH_SERVICE_KEY 

L'uso di CI/CD in GitLab per generare le proprie apps


CI/CD YAML syntax reference

Runners

Pipelines

Variables

External secrets

Services

Auto DevOps

Testing

SSH keys



#######################################
# SOFTWARE NCESSARIO PER IL CORSO

### vagrant
https://developer.hashicorp.com/vagrant/install?ajs_aid=591c6900-1721-44f9-8710-1b44829b9412&product_intent=vagrant

### virtualbox
https://www.virtualbox.org/wiki/Downloads

### vscode
https://code.visualstudio.com/download